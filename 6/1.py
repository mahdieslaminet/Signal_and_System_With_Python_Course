# %% [markdown]
# <h1 style="text-align:right;">فصل هفتم: نمونه برداری</h1>
# <h2 style="text-align:right; direction: rtl;">مقدمه</h2>
# 
# <div style="text-align:right; direction: rtl;">
#   در شرایط معینی با دانستن مقادیر لحظه ای یا نمونه های گرفته شده در زمانهای متساوی الفاصله از یک سیگنال پیوسته در زمان، میتوان آن سیگنال را به طور کامل نمایش داد یا بازسازی کرد. این خاصیت نسبتاً عجیب از یک اصل اساسی به نام قضیه نمونه برداری نتیجه گرفته میشود. این قضیه بسیار مهم و مفید است. برای مثال از این قضیه در تصویرهای متحرک استفاده میشود که از یک رشته فریم تشکیل شده اند و هر کدام نمایی لحظه ای (یعنی نمونه برداری زمانی از رخدادی هستند که پیوسته تغییر میکند). اگر این نمونه ها را پشت سر هم و با سرعت کافی مشاهده کنیم، نمایش دقیقی از رخداد اصلی را درک میکنیم. مثال دیگر عکس است که از شبکه ظریفی از نقاط تشکیل شده و هر نقطه با نمونه ای از یک تصویر پیوسته در مکان متناظر ست. اگر این نمونه ها به اندازه کافی به هم نزدیک باشند، عکس پیوسته به نظر می رسد، هر چند زیر ذره بین وجود نقطه های منفصل آشکار می شود. بیشتر اهمیت قضیه نمونه برداری در نقش واسطه ای آن بین سیگنالهای پیوسته در زمان و سیگنالهای گسسته در زمان است. در این فصل خواهیم دید که امکان نمایش کامل یک سیگنال پیوسته در زمان به وسیله نمونه های آن در شرایط معین مکانیسمی برای نمایش سیگنالهای پیوسته در زمان به وسیله گسسته در زمان به دست می دهد. در بسیاری از موارد پردازش سیگنالهای گسسته در زمان با انعطاف بیشتری انجام می شود و غالباً به پردازش سیگنالهای پیوسته در زمان ترجیح داده می شود. این امر تا حد زیادی از گسترش چشمگیر تکنولوژی دیجیتال در چند دهه اخیر ناشی شده است. این تکنولوژی سیستمهای ارزان، سبک، برنامه پذیر، و قابل بازسازی را به همراه داشته است. بنابراین مفهوم نمونه برداری راه بسیار جالب و پر استفاده ای برای استفاده از تکنولوژی گسسته در زمان برای ساختن سیستمهای پردازش سیگنالهای پیوسته در زمان در پیش پایمان می گذارد. با نمونه برداری سیگنال پیوسته در زمان را به یک سیگنال گسسته در زمان تبدیل میکنیم.
# </div>
# 
# 
# <br>
# 
# <div style="text-align:right; direction: rtl;">
#   سیگنال گسسته در زمان را با یک سیستم گسسته در زمان پردازش میکنیم و سپس آن را دوباره به صورت پیوسته در زمان در می آوریم. در بحث زیر مفهوم نمونه برداری و فرایند بازسازی سیگنال پیوسته در زمان از روی نمونه های آن را معرفی میکنیم. در این بحث هم شرایط لازم برای امکان بازسازی یک سیگنال از نمونه هایش را تشخیص می دهیم و هم میبینیم که در صورت ارضا نشدن این شرایط چه پیش می آید. سپس پردازش سیگنالهای پیوسته در زمانی را که با نمونه گیری به سیگنالهای گسسته در زمان تبدیل شده اند در نظر میگیریم. سرانجام نمونه برداری از سیگنالهای گسسته در زمان و مفاهیم تخمین و درونیایی را مورد بررسی قرار میدهیم.
# </div>
# <br>
# <h2 style="text-align:right; direction: rtl; margin-bottom: 5px;">1. نمایش سیگنال پیوسته در زمان توسط نمونه‌های آن:</h2>
# <h2 style="text-align:right; direction: rtl; margin-top: 0; margin-bottom: 10px;">قضیه نمونه برداری</h2>
# <br>
# <div style="text-align:right; direction: rtl; line-height: 1.6;">
#   در حالت کلی انتظار نداریم که بدون وجود شرایط یا اطلاعات اضافی سیگنالی به طور یکتا توسط رشته ای از نمونه های متساوی الفاصله اش مشخص شود. برای مثال شکل ۷-۱ سه سیگنال پیوسته در زمان متفاوت را نشان می دهد که مقادیرشان در مضارب صحیح T یکسان است ؛ یعنی 
#  <div style="text-align:center; direction: rtl;">
#   x<sub>1</sub>(kT) = x<sub>2</sub>(kT) = x<sub>3</sub>(kT)
# </div>
#   واضح است که تعداد سیگنالهایی که نمونه های مشابهی تولید میکنند بینهایت است. ولی خواهیم دید که اگر باند یک سیگنال محدود باشد، یعنی تبدیل فوریه آن در خارج یک باند فرکانسی محدود صفر باشد، و اگر نمونه ها به حد کافی به هم نزدیک باشند آنگاه نمونه ها به طور یکتا سیگنال را مشخص میکنند، و می توان سیگنال را به طور کامل بازسازی کرد. نزدیکی نمونه ها با بزرگترین فرکانس موجود در سیگنال ارتباط دارد. این گزاره را قضیه نمونه برداری مینامند و در کاربردهای عملی روشهای تحلیل سیگنالها و سیستمها اهمیتی شایان دارد.
# </div>

# %%
import numpy as np
import matplotlib.pyplot as plt

# تعریف پارامترها
T = 1
t = np.arange(-3*T, 3*T, 0.01)

# تعریف سیگنال‌ها
x1 = np.sin(2 * np.pi * t / T)
x2 = np.cos(2 * np.pi * t / T)
x3 = np.sin(2 * np.pi * t / T) * np.cos(2 * np.pi * t / T)

# رسم سیگنال‌ها
plt.plot(t, x1, 'r', label='x_1(t)')
plt.plot(t, x2, '--g', label='x_2(t)')
plt.plot(t, x3, ':b', label='x_3(t)')

# تنظیمات نمودار
plt.xlabel('t')
plt.ylabel('Amplitude')
plt.title('Three continuous-time signals with identical values at integer multiples of T')
plt.suptitle('7-1', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True)
plt.show()


# %% [markdown]
# <h2 style="text-align:right; direction: rtl;">نمونه‌برداری با قطار ضربه</h2>
# <div style="text-align:right; direction: rtl;">
#     برای بیان قضیه نمونه‌برداری به راه مناسبی برای بیان نمونه‌های یک سیگنال پیوسته در زمان در فاصله‌های مساوی نیاز داریم. 
#     یک راه مناسب برای انجام این کار استفاده از حاصل‌ضرب یک قطار ضربه متناوب و سیگنال پیوسته در زمان 
#     <b>x(t)</b> است. این فرآیند، که نمونه‌برداری با قطار ضربه نام دارد، در رابطه زیر تعریف می‌شود:
# </div>
# 
# $$
# x_p(t) = x(t) \cdot p(t)
# $$
# 
# <div style="text-align:right; direction: rtl;">
#     که در آن:
# </div>
# 
# $$
# p(t) = \sum_{{n=-\infty}}^{{\infty}} \delta(t - nT)
# $$
# 
# <div style="text-align:right; direction: rtl;">
#     و فرکانس نمونه‌برداری به صورت زیر تعریف می‌شود:
# </div>
# 
# $$
# \Omega_s = \frac{{2\pi}}{{T}}
# $$
# 

# %%
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.patches as mpatches
import matplotlib.image as mpimg

# تنظیمات کلی برای شکل
plt.rcParams.update({
    "text.usetex": False,  # غیرفعال کردن LaTeX
    "font.family": "serif",
    "axes.grid": False
})

# 1. تعریف تابع اصلی x(t)
t = np.linspace(-1, 1, 1000)
x_t = np.sin(2 * np.pi * t) + 0.5 * np.sin(6 * np.pi * t)

# 2. تعریف قطار ضربه p(t)
T = 0.2  # فاصله نمونه‌برداری
p_t = np.zeros_like(t)
p_t[::int(len(t) * T / (t[-1] - t[0]))] = 1  # ضربه‌ها در فواصل T

# 3. نتیجه نمونه‌برداری x_p(t)
x_p_t = x_t * p_t

# رسم نمودارها
fig, axs = plt.subplots(4, 1, figsize=(8, 12))  # تغییر اندازه شکل

# نمودار 1: x(t)
axs[0].plot(t, x_t, label=r"$x(t)$")
axs[0].set_title("function $x(t)$")
axs[0].set_xlim(-1, 1)
axs[0].set_ylim(-2, 2)
axs[0].legend()

# نمودار 2: p(t)
axs[1].stem(t, p_t, linefmt='C1-', markerfmt='C1o', basefmt='C1-', label=r"$p(t)$")
axs[1].set_title("Impulse-Train Sampling $p(t)$")
axs[1].set_xlim(-1, 1)
axs[1].legend()

# نمودار 3: x_p(t) = x(t) * p(t)
axs[2].stem(t, x_p_t, linefmt='C2-', markerfmt='C2o', basefmt='C2-', label=r"$x_p(t)$")
axs[2].plot(t, x_t, 'k--', alpha=0.5, label=r"$x(t)$ (source)")
axs[2].set_title(r"Sampling $x_p(t) = x(t) \cdot p(t)$")
axs[2].set_xlim(-1, 1)
axs[2].set_ylim(-2, 2)
axs[2].legend()

# نمودار 4: نمایش تصویر به جای بلوک دیاگرام
axs[3].axis('off')

# بارگذاری تصویر و نمایش آن
img = mpimg.imread('diagram0.png')  # اطمینان حاصل کنید که نام فایل درست است و در مسیر قرار دارد
axs[3].imshow(img)
axs[3].set_title('System Diagram')

plt.subplots_adjust(hspace=0.5, wspace=0.5)

# نمایش نمودار
plt.show()


# %% [markdown]
# 


